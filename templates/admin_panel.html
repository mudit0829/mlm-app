<!DOCTYPE html>
<html>
<head><title>Admin Panel</title></head>
<body>
  <h2>Admin Panel - View All Users</h2>
  <div id="usersList"></div>

  <script>
    async function loadAdminPanel() {
      // Prompt for admin username and password (simplified demo)
      let username = prompt("Enter admin username:");
      let password = prompt("Enter admin password:");

      if (!username || !password) {
        alert("Admin login required");
        return;
      }

      // Admin login to get admin user ID
      let loginRes = await fetch('https://mlm-app-3d3y.onrender.com/admin/login', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({username, password})
      });
      let loginData = await loginRes.json();

      if (!loginData.user_id) {
        alert(loginData.message || "Invalid admin credentials");
        return;
      }

      // Fetch all users
      let res = await fetch(`https://mlm-app-3d3y.onrender.com/admin/${loginData.user_id}/all_users`);
      let users = await res.json();

      if (Array.isArray(users)) {
        let html = '<table border="1" cellpadding="5"><tr><th>User ID</th><th>Username</th><th>Sponsor ID</th><th>Power Leg</th><th>Directs</th></tr>';
        users.forEach(u => {
          html += `<tr>
            <td>${u.user_id}</td>
            <td>${u.username}</td>
            <td>${u.sponsor_id || ''}</td>
            <td>${u.power_leg || ''}</td>
            <td>${u.directs.join(', ')}</td>
          </tr>`;
        });
        html += '</table>';
        document.getElementById('usersList').innerHTML = html;
      } else {
        alert('Failed to load users list');
      }
    }

    loadAdminPanel();
  </script
